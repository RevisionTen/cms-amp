(self.AMP=self.AMP||[]).push({n:"amp-app-banner",v:"0",f:(function(AMP,_){
var h="function"==typeof Object.create?Object.create:function(a){function b(){}b.prototype=a;return new b},k;if("function"==typeof Object.setPrototypeOf)k=Object.setPrototypeOf;else{var l;a:{var m={a:!0},n={};try{n.__proto__=m;l=n.a;break a}catch(a){}l=!1}k=l?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}var p=k;
function q(a,b){a.prototype=h(b.prototype);a.prototype.constructor=a;if(p)p(a,b);else for(var c in b)if("prototype"!=c)if(Object.defineProperties){var e=Object.getOwnPropertyDescriptor(b,c);e&&Object.defineProperty(a,c,e)}else a[c]=b[c];a.C=b.prototype};function r(){var a,b;this.promise=new Promise(function(c,e){a=c;b=e});this.resolve=a;this.reject=b};function t(a,b){b=void 0===b?"":b;try{return decodeURIComponent(a)}catch(c){return b}};var u=/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;function v(a){for(var b=null,c="",e=0;e<arguments.length;e++){var d=arguments[e];if(d instanceof Error&&!b){b=void 0;var f=Object.getOwnPropertyDescriptor(d,"message");if(f&&f.writable)b=d;else{f=d.stack;var g=Error(d.message);for(b in d)g[b]=d[b];g.stack=f;b=g}}else c&&(c+=" "),c+=d}b?c&&(b.message=c+": "+b.message):b=Error(c);return b}function w(a){var b=v.apply(null,arguments);setTimeout(function(){self.__AMP_REPORT_ERROR(b);throw b;})}self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};
var x=self.__AMP_LOG;function y(){if(!x.user)throw Error("failed to call initLogConstructor");return x.user}function z(){if(x.dev)return x.dev;throw Error("failed to call initLogConstructor");}function A(a,b,c,e){return y().assert(a,b,c,e,void 0,void 0,void 0,void 0,void 0,void 0,void 0)};var B=Object.prototype.hasOwnProperty;function D(a){return a||{}};D({c:!0,v:!0,a:!0,ad:!0,action:!0});function E(a,b){if(a.__AMP__EXPERIMENT_TOGGLES)var c=a.__AMP__EXPERIMENT_TOGGLES;else{a.__AMP__EXPERIMENT_TOGGLES=Object.create(null);c=a.__AMP__EXPERIMENT_TOGGLES;if(a.AMP_CONFIG)for(var e in a.AMP_CONFIG){var d=a.AMP_CONFIG[e];"number"===typeof d&&0<=d&&1>=d&&(c[e]=Math.random()<d)}if(a.AMP_CONFIG&&Array.isArray(a.AMP_CONFIG["allow-doc-opt-in"])&&0<a.AMP_CONFIG["allow-doc-opt-in"].length&&(e=a.AMP_CONFIG["allow-doc-opt-in"],d=a.document.head.querySelector('meta[name="amp-experiments-opt-in"]'))){d=
d.getAttribute("content").split(",");for(var f=0;f<d.length;f++)-1!=e.indexOf(d[f])&&(c[d[f]]=!0)}Object.assign(c,aa(a));if(a.AMP_CONFIG&&Array.isArray(a.AMP_CONFIG["allow-url-opt-in"])&&0<a.AMP_CONFIG["allow-url-opt-in"].length){e=a.AMP_CONFIG["allow-url-opt-in"];d=a.location.originalHash||a.location.hash;a=Object.create(null);if(d)for(var g;g=u.exec(d);)f=t(g[1],g[1]),g=g[2]?t(g[2].replace(/\+/g," "),g[2]):"",a[f]=g;for(d=0;d<e.length;d++)f=a["e-"+e[d]],"1"==f&&(c[e[d]]=!0),"0"==f&&(c[e[d]]=!1)}}var C=
c;return!!C[b]}function aa(a){var b="";try{"localStorage"in a&&(b=a.localStorage.getItem("amp-experiment-toggles"))}catch(d){z().warn("EXPERIMENTS","Failed to retrieve experiments from localStorage.")}var c=b?b.split(/\s*,\s*/g):[];a=Object.create(null);for(var e=0;e<c.length;e++)0!=c[e].length&&("-"==c[e][0]?a[c[e].substr(1)]=!1:a[c[e]]=!0);return a};var F={},G=(F["ampdoc-fie"]={isTrafficEligible:function(){return!0},branches:[["21065001"],["21065002"]]},F);function H(a){var b=a.ownerDocument.defaultView,c=b.__AMP_TOP||(b.__AMP_TOP=b),e=b!=c;var d=c;if(E(d,"ampdoc-fie")){d.__AMP_EXPERIMENT_BRANCHES=d.__AMP_EXPERIMENT_BRANCHES||{};for(var f in G)if(B.call(G,f)&&!B.call(d.__AMP_EXPERIMENT_BRANCHES,f))if(G[f].isTrafficEligible&&G[f].isTrafficEligible(d)){if(!d.__AMP_EXPERIMENT_BRANCHES[f]&&E(d,f)){var g=G[f].branches;d.__AMP_EXPERIMENT_BRANCHES[f]=g[Math.floor(Math.random()*g.length)]||null}}else d.__AMP_EXPERIMENT_BRANCHES[f]=null;d="21065002"===(d.__AMP_EXPERIMENT_BRANCHES?
d.__AMP_EXPERIMENT_BRANCHES["ampdoc-fie"]:null)}else d=!1;var C=d;e&&!C?a=I(b,"url")?J(b,"url"):null:(a=K(a),a=L(a),a=I(a,"url")?J(a,"url"):null);return a}function M(a,b){a=a.__AMP_TOP||(a.__AMP_TOP=a);return J(a,b)}function N(a,b){var c=K(a);c=L(c);return J(c,b)}function K(a){return a.nodeType?M((a.ownerDocument||a).defaultView,"ampdoc").getAmpDoc(a):a}function L(a){a=K(a);return a.isSingleDoc()?a.win:a}
function J(a,b){I(a,b);var c=O(a);a=c[b];a.obj||(a.obj=new a.ctor(a.context),a.ctor=null,a.context=null,a.resolve&&a.resolve(a.obj));return a.obj}function P(a){var b;(b=O(a).storage)?b.promise?b=b.promise:(J(a,"storage"),b=b.promise=Promise.resolve(b.obj)):b=null;var c=b;if(c)return c;a=O(a);a.storage=ba();return a.storage.promise}function O(a){var b=a.__AMP_SERVICES;b||(b=a.__AMP_SERVICES={});return b}function I(a,b){a=a.__AMP_SERVICES&&a.__AMP_SERVICES[b];return!(!a||!a.ctor&&!a.obj)}
function ba(){var a=new r,b=a,c=b.promise,e=b.resolve;b=b.reject;c.catch(function(){});return{obj:null,promise:c,resolve:e,reject:b,context:null,ctor:null}};/*
 https://mths.be/cssescape v1.5.1 by @mathias | MIT license */
function Q(a,b){var c;try{a.open(b,"_top",c)}catch(e){z().error("DOM","Failed to open url on target: ","_top",e)}};function R(a){a=AMP.BaseElement.call(this,a)||this;a.m=null;a.j=!1;return a}q(R,AMP.BaseElement);R.prototype.openButtonClicked=function(){};function S(a,b,c,e){b.addEventListener("click",function(){a.openButtonClicked(c,e)})}R.prototype.B=function(){this.getVsync().run({measure:void 0,mutate:ca},{element:this.element,viewport:this.getViewport(),storagePromise:P(L(this.getAmpDoc())),storageKey:T(this)})};
function T(a){var b=A(a.element.id,"amp-app-banner should have an id.");return"amp-app-banner:"+b}R.prototype.isDismissed=function(){var a=this;return P(L(this.getAmpDoc())).then(function(b){return b.get(T(a))}).then(function(a){return!!a},function(a){z().error("amp-app-banner","Failed to read storage",a);return!1})};
function U(a){a.isDismissed().then(function(b){if(b)V(a);else{var c=a.win.document.createElement("i-amphtml-app-banner-top-padding");a.element.appendChild(c);c=a.win.document.createElement("button");c.classList.add("amp-app-banner-dismiss-button");c.setAttribute("aria-label",a.element.getAttribute("data-dismiss-button-aria-label")||"Dismiss");var e=a.B.bind(a);c.addEventListener("click",e);a.element.appendChild(c);a.getVsync().run({measure:da,mutate:ea},{element:a.element,viewport:a.getViewport()});
a.expand()}})}function V(a){return a.getVsync().runPromise({measure:void 0,mutate:W},{element:a.element,viewport:a.getViewport()})}function X(a){return R.call(this,a)||this}q(X,R);X.prototype.upgradeCallback=function(){var a=M(this.win,"platform");return a.isIos()?new Y(this.element):a.isAndroid()?new Z(this.element):null};X.prototype.layoutCallback=function(){y().info("amp-app-banner","Only iOS or Android platforms are currently supported.");return V(this)};
function Y(a){a=R.call(this,a)||this;a.h=null;a.w=null;return a}q(Y,R);Y.prototype.preconnectCallback=function(a){this.element.parentNode&&this.preconnect.url("https://itunes.apple.com",a)};
Y.prototype.buildCallback=function(){this.h=N(this.getAmpDoc(),"viewer");var a=M(this.win,"platform");(this.j=!this.h.isEmbedded()&&a.isSafari())?(y().info("amp-app-banner","Browser supports builtin banners. Not rendering amp-app-banner."),V(this)):this.h.isEmbedded()&&!this.h.hasCapability("navigateTo")?V(this):(this.w=this.win.document.head.querySelector("meta[name=apple-itunes-app]"))?(this.m=A(this.element.querySelector("button[open-button]"),"<button open-button> is required inside %s: %s","amp-app-banner",
this.element),fa(this,this.w.getAttribute("content")),U(this)):V(this)};Y.prototype.layoutCallback=function(){return Promise.resolve()};Y.prototype.openButtonClicked=function(a,b){var c=this;this.h.isEmbedded()?(M(this.win,"timer").delay(function(){c.h.sendMessage("navigateTo",D({url:b}))},1500),this.h.sendMessage("navigateTo",D({url:a}))):(M(this.win,"timer").delay(function(){Q(c.win,b)},1500),Q(this.win,a))};
function fa(a,b){var c={};b.replace(/\s/,"").split(",").forEach(function(a){var b=a.split("=");c[b[0]]=b[1]});var e=c["app-id"],d=c["app-argument"];d?A(H(a.element).isProtocolValid(d),"The url in app-argument has invalid protocol: %s",d):y().error("amp-app-banner",'<meta name="apple-itunes-app">\'s content should contain app-argument to allow opening an already installed application on iOS.');e="https://itunes.apple.com/us/app/id"+e;S(a,a.m,d||e,e)}
function Z(a){a=R.call(this,a)||this;a.o=null;a.l="";a.A=!1;return a}q(Z,R);Z.prototype.preconnectCallback=function(a){this.element.parentNode&&(this.preconnect.url("https://play.google.com",a),this.l&&this.preconnect.preload(this.l))};
Z.prototype.buildCallback=function(){var a=this.win,b=this.element,c=N(this.getAmpDoc(),"viewer");this.o=a.document.head.querySelector("link[rel=manifest],link[rel=origin-manifest]");var e=M(a,"platform"),d=H(b),f=e.isAndroid()&&e.isChrome(),g=d.isProxyOrigin(a.location);(this.j=!g&&!c.isEmbedded()&&f)?(y().info("amp-app-banner","Browser supports builtin banners. Not rendering amp-app-banner."),V(this)):(this.A=e.isAndroid()&&!this.o)?V(this):(this.l=this.o.getAttribute("href"),d.assertHttpsUrl(this.l,
b,"manifest href"),this.m=A(b.querySelector("button[open-button]"),"<button open-button> is required inside %s: %s","amp-app-banner",b),U(this))};
Z.prototype.layoutCallback=function(){var a=this;return this.A||this.j?Promise.resolve():M(this.win,"xhr").fetchJson(this.l,{}).then(function(a){return a.json()}).then(function(b){var c;a:{if(c=b.related_applications){for(var e=0;e<c.length;e++){var d=c[e];if("play"==d.platform){c="https://play.google.com/store/apps/details?id="+d.id;d=d.id;e=a.element;var f=N(e,"documentInfo").get().canonicalUrl;e=H(e).parse(f);f=e.protocol.replace(":","");S(a,a.m,"android-app://"+d+"/"+f+"/"+e.host+e.pathname,c);
c=void 0;break a}}y().warn("amp-app-banner","Could not find a platform=play app in manifest: %s",a.element)}else y().warn("amp-app-banner","related_applications is missing from manifest.json file: %s",a.element);c=void 0}return c}).catch(function(b){V(a);w(b)})};Z.prototype.openButtonClicked=function(a,b){var c=this;M(this.win,"timer").delay(function(){c.win.top.location.assign(b)},1500);Q(this.win,a)};function ca(a){W(a);a.storagePromise.then(function(b){b.set(a.storageKey,!0)})}
function W(a){a.viewport.removeFromFixedLayer(a.element);var b=a.element;b.parentElement&&b.parentElement.removeChild(b);a.viewport.updatePaddingBottom(0)}function da(a){a.bannerHeight=a.viewport.getLayoutRect(a.element).height}function ea(a){a.viewport.updatePaddingBottom(a.bannerHeight);a.viewport.addToFixedLayer(a.element)}(function(a){a.registerElement("amp-app-banner",X,"amp-app-banner{position:fixed!important;bottom:0!important;left:0;width:100%;max-height:100px!important;box-sizing:border-box;background:#fff;z-index:13;box-shadow:0 0 5px 0 rgba(0,0,0,0.2)!important}i-amphtml-app-banner-top-padding{position:absolute;top:0;left:0;right:0;background:#fff;height:4px;z-index:15}.amp-app-banner-dismiss-button{position:absolute;width:28px;height:28px;top:-28px;right:0;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='13' height='13' viewBox='341 8 13 13' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill='%234F4F4F' d='M354 9.31L352.69 8l-5.19 5.19L342.31 8 341 9.31l5.19 5.19-5.19 5.19 1.31 1.31 5.19-5.19 5.19 5.19 1.31-1.31-5.19-5.19z' fill-rule='evenodd'/%3E%3C/svg%3E\");background-size:13px 13px;background-position:9px;background-color:#fff;background-repeat:no-repeat;z-index:14;box-shadow:0 -1px 1px 0 rgba(0,0,0,0.2);border:none;border-radius:12px 0 0 0}.amp-app-banner-dismiss-button:before{position:absolute;content:\"\";top:-20px;right:0;left:-20px;bottom:0}[dir=rtl] .amp-app-banner-dismiss-button{right:auto;left:0;border-top-left-radius:0;border-top-right-radius:12px;background-position:6px}[dir=rtl] .amp-app-banner-dismiss-button:before{right:-20px;left:0}\n/*# sourceURL=/extensions/amp-app-banner/0.1/amp-app-banner.css*/")})(self.AMP);
})});

//# sourceMappingURL=amp-app-banner-0.1.js.map
