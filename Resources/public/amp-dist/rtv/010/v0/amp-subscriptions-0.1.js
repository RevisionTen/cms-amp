(self.AMP=self.AMP||[]).push({n:"amp-subscriptions",v:"0",f:(function(AMP,_){
var h,aa="function"==typeof Object.create?Object.create:function(a){function b(){}b.prototype=a;return new b},ba;if("function"==typeof Object.setPrototypeOf)ba=Object.setPrototypeOf;else{var ca;a:{var da={a:!0},ea={};try{ea.__proto__=da;ca=ea.a;break a}catch(a){}ca=!1}ba=ca?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}var fa=ba;
function ha(a,b){a.prototype=aa(b.prototype);a.prototype.constructor=a;if(fa)fa(a,b);else for(var c in b)if("prototype"!=c)if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(b,c);d&&Object.defineProperty(a,c,d)}else a[c]=b[c];a.Hb=b.prototype}function ia(a){return a?Array.prototype.slice.call(a):[]};var p=Object.prototype.hasOwnProperty;function ja(){var a,b=Object.create(null);a&&Object.assign(b,a);return b}function r(a){return a||{}};function v(){var a,b;this.promise=new Promise(function(c,d){a=c;b=d});this.resolve=a;this.reject=b};function ka(a,b){b=void 0===b?"":b;try{return decodeURIComponent(a)}catch(c){return b}};var la=/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;function ma(a){var b=Object.create(null);if(!a)return b;for(var c;c=la.exec(a);){var d=ka(c[1],c[1]),e=c[2]?ka(c[2].replace(/\+/g," "),c[2]):"";b[d]=e}return b};var na="";
function oa(){var a,b=a||self;if(b.__AMP_MODE)var c=b.__AMP_MODE;else{c=b;var d=self.AMP_CONFIG||{},e=!!d.test||!1,f=ma(c.location.originalHash||c.location.hash);d=d.spt;var g=ma(c.location.search);na||(na=c.AMP_CONFIG&&c.AMP_CONFIG.v?c.AMP_CONFIG.v:"010");c={localDev:!1,development:!!(0<=["1","actions","amp","amp4ads","amp4email"].indexOf(f.development)||c.AMP_DEV_MODE),examiner:"2"==f.development,geoOverride:f["amp-geo"],userLocationOverride:f["amp-user-location"],minified:!0,lite:void 0!=g.amp_lite,
test:e,log:f.log,version:"0",rtvVersion:na,singlePassType:d};c=b.__AMP_MODE=c}return c};var B=self.AMP_CONFIG||{},pa={thirdParty:B.thirdPartyUrl||"https://3p.ampproject.net",thirdPartyFrameHost:B.thirdPartyFrameHost||"ampproject.net",thirdPartyFrameRegex:("string"==typeof B.thirdPartyFrameRegex?new RegExp(B.thirdPartyFrameRegex):B.thirdPartyFrameRegex)||/^d-\d+\.ampproject\.net$/,cdn:B.cdnUrl||"https://cdn.ampproject.org",cdnProxyRegex:("string"==typeof B.cdnProxyRegex?new RegExp(B.cdnProxyRegex):B.cdnProxyRegex)||/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org$/,localhostRegex:/^https?:\/\/localhost(:\d+)?$/,
errorReporting:B.errorReportingUrl||"https://amp-error-reporting.appspot.com/r",localDev:B.localDev||!1,trustedViewerHosts:[/(^|\.)google\.(com?|[a-z]{2}|com?\.[a-z]{2}|cat)$/,/(^|\.)gmail\.(com|dev)$/]};self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var qa=self.__AMP_LOG;function C(){if(!qa.user)throw Error("failed to call initLogConstructor");return qa.user}function ua(){if(qa.dev)return qa.dev;throw Error("failed to call initLogConstructor");}function D(a,b,c,d,e){return C().assert(a,b,c,d,e,void 0,void 0,void 0,void 0,void 0,void 0)};function va(){var a=100;this.lb=a;this.L=this.Qa=0;this.ma=Object.create(null)}va.prototype.has=function(a){return!!this.ma[a]};va.prototype.get=function(a){var b=this.ma[a];if(b)return b.access=++this.L,b.payload};va.prototype.put=function(a,b){this.has(a)||this.Qa++;this.ma[a]={payload:b,access:this.L};if(!(this.Qa<=this.lb)){ua().warn("lru-cache","Trimming LRU cache");a=this.ma;var c=this.L+1,d;for(d in a){var e=a[d].access;if(e<c){c=e;var f=d}}void 0!==f&&(delete a[f],this.Qa--)}};var wa=r({c:!0,v:!0,a:!0,ad:!0,action:!0}),xa,ya,za=/[?&]amp_js[^&]*/,Aa=/[?&]amp_gsa[^&]*/,Ba=/[?&]amp_r[^&]*/,Ca=/[?&]amp_kit[^&]*/,Da=/[?&]usqp[^&]*/;function Ea(a){return a.origin||E(a.location.href).origin}
function E(a){var b;xa||(xa=self.document.createElement("a"),ya=self.__AMP_URL_CACHE||(self.__AMP_URL_CACHE=new va));var c=b?null:ya,d=xa;if(c&&c.has(a))a=c.get(a);else{d.href=a;d.protocol||(d.href=d.href);var e={href:d.href,protocol:d.protocol,host:d.host,hostname:d.hostname,port:"0"==d.port?"":d.port,pathname:d.pathname,search:d.search,hash:d.hash,origin:null};"/"!==e.pathname[0]&&(e.pathname="/"+e.pathname);if("http:"==e.protocol&&80==e.port||"https:"==e.protocol&&443==e.port)e.port="",e.host=
e.hostname;e.origin=d.origin&&"null"!=d.origin?d.origin:"data:"!=e.protocol&&e.host?e.protocol+"//"+e.host:e.href;d=oa().test&&Object.freeze?Object.freeze(e):e;c&&c.put(a,d);a=d}return a}function Fa(a,b){b=encodeURIComponent("crypt")+"="+encodeURIComponent(b);if(b){a=a.split("#",2);var c=a[0].split("?",2);b=c[0]+(c[1]?"?"+c[1]+"&"+b:"?"+b);b+=a[1]?"#"+a[1]:""}else b=a;return b}
function Ga(a,b){var c=void 0===c?"source":c;D(null!=a,"%s %s must be available",b,c);var d=a;a=d;"string"==typeof a&&(a=E(a));var e;(e="https:"==a.protocol||"localhost"==a.hostname||"127.0.0.1"==a.hostname)||(a=a.hostname,e=a.length-10,e=0<=e&&a.indexOf(".localhost",e)==e);D(e||/^(\/\/)/.test(d),'%s %s must start with "https://" or "//" or be relative and served from either https or from localhost. Invalid value: %s',b,c,d);return d};function Ha(a,b){if(a.__AMP__EXPERIMENT_TOGGLES)var c=a.__AMP__EXPERIMENT_TOGGLES;else{a.__AMP__EXPERIMENT_TOGGLES=Object.create(null);c=a.__AMP__EXPERIMENT_TOGGLES;if(a.AMP_CONFIG)for(var d in a.AMP_CONFIG){var e=a.AMP_CONFIG[d];"number"===typeof e&&0<=e&&1>=e&&(c[d]=Math.random()<e)}if(a.AMP_CONFIG&&Array.isArray(a.AMP_CONFIG["allow-doc-opt-in"])&&0<a.AMP_CONFIG["allow-doc-opt-in"].length&&(d=a.AMP_CONFIG["allow-doc-opt-in"],e=a.document.head.querySelector('meta[name="amp-experiments-opt-in"]'))){e=
e.getAttribute("content").split(",");for(var f=0;f<e.length;f++)-1!=d.indexOf(e[f])&&(c[e[f]]=!0)}Object.assign(c,Ia(a));if(a.AMP_CONFIG&&Array.isArray(a.AMP_CONFIG["allow-url-opt-in"])&&0<a.AMP_CONFIG["allow-url-opt-in"].length)for(d=a.AMP_CONFIG["allow-url-opt-in"],a=ma(a.location.originalHash||a.location.hash),e=0;e<d.length;e++)f=a["e-"+d[e]],"1"==f&&(c[d[e]]=!0),"0"==f&&(c[d[e]]=!1)}var g=c;return!!g[b]}
function Ia(a){var b="";try{"localStorage"in a&&(b=a.localStorage.getItem("amp-experiment-toggles"))}catch(e){ua().warn("EXPERIMENTS","Failed to retrieve experiments from localStorage.")}var c=b?b.split(/\s*,\s*/g):[];a=Object.create(null);for(var d=0;d<c.length;d++)0!=c[d].length&&("-"==c[d][0]?a[c[d].substr(1)]=!1:a[c[d]]=!0);return a};var Ja={},F=(Ja["ampdoc-fie"]={isTrafficEligible:function(){return!0},branches:[["21065001"],["21065002"]]},Ja);function G(a,b){a=a.__AMP_TOP||(a.__AMP_TOP=a);return H(a,b)}function K(a,b){var c=Ka(a);c=L(c);return H(c,b)}function Ka(a){return a.nodeType?G((a.ownerDocument||a).defaultView,"ampdoc").getAmpDoc(a):a}function L(a){a=Ka(a);return a.isSingleDoc()?a.win:a}function H(a,b){La(a,b);var c=Ma(a);a=c[b];a.obj||(a.obj=new a.ctor(a.context),a.ctor=null,a.context=null,a.resolve&&a.resolve(a.obj));return a.obj}function Na(a,b){var c=Oa(a,b);if(c)return c;a=Ma(a);a[b]=Pa();return a[b].promise}
function Oa(a,b){var c=Ma(a)[b];if(c){if(c.promise)return c.promise;H(a,b);return c.promise=Promise.resolve(c.obj)}return null}function Ma(a){var b=a.__AMP_SERVICES;b||(b=a.__AMP_SERVICES={});return b}function La(a,b){a=a.__AMP_SERVICES&&a.__AMP_SERVICES[b];return!(!a||!a.ctor&&!a.obj)}function Pa(){var a=new v,b=a,c=b.promise,d=b.resolve;b=b.reject;c.catch(function(){});return{obj:null,promise:c,resolve:d,reject:b,context:null,ctor:null}};/*
 https://mths.be/cssescape v1.5.1 by @mathias | MIT license */
var Qa;function Ra(a,b,c){if(b(a))c();else{var d=a.ownerDocument.defaultView;if(d.MutationObserver){var e=new d.MutationObserver(function(){b(a)&&(e.disconnect(),c())});e.observe(a,{childList:!0})}else var f=d.setInterval(function(){b(a)&&(d.clearInterval(f),c())},5)}}function Sa(a,b,c){a=a.createElement(b);for(var d in c)a.setAttribute(d,c[d]);return a}function Ta(a,b){for(var c;a&&a!==c;a=a.parentElement)if(b(a))return a;return null}
function Ua(a){return a.closest?a.closest("[subscriptions-action]"):Ta(a,function(a){var b=a.matches||a.webkitMatchesSelector||a.mozMatchesSelector||a.msMatchesSelector||a.oMatchesSelector;return b?b.call(a,"[subscriptions-action]"):!1})}
function Va(a){/^[\w-]+$/.test("footer");if(void 0!==Qa)var b=Qa;else{try{var c=a.ownerDocument,d=c.createElement("div"),e=c.createElement("div");d.appendChild(e);b=d.querySelector(":scope div")===e}catch(f){b=!1}b=Qa=b}b?a=a.querySelector("> footer".replace(/^|,/g,"$&:scope ")):(a.classList.add("i-amphtml-scoped"),b="> footer".replace(/^|,/g,"$&.i-amphtml-scoped "),b=a.querySelectorAll(b),a.classList.remove("i-amphtml-scoped"),a=void 0===b[0]?null:b[0]);return a}
function Wa(a,b){for(var c=a.length,d=0;d<c;d++)b(a[d],d)}function Xa(a,b,c){try{var d=a.open(b,"_blank",c)}catch(g){ua().error("DOM","Failed to open url on target: ","_blank",g)}var e;if(!(e=d||!1)){e=c||"";var f;"number"!==typeof f&&(f=0);e=f+8>e.length?!1:-1!==e.indexOf("noopener",f)}e||(d=a.open(b,"_top"));return d};function Ya(a){var b=Oa(L(a),"amp-analytics-instrumentation");if(b)return b;var c=Ka(a);return c.waitForBodyOpen().then(function(){var a=c.win;var b=c.win.document.head;if(b){var f={};b=b.querySelectorAll("script[custom-element],script[custom-template]");for(var g=0;g<b.length;g++){var k=b[g];k=k.getAttribute("custom-element")||k.getAttribute("custom-template");f[k]=!0}f=Object.keys(f)}else f=[];a=f.includes("amp-analytics")?G(a,"extensions").waitForExtension(a,"amp-analytics"):Promise.resolve();
return a}).then(function(){var b=c.win;return b.__AMP_EXTENDED_ELEMENTS&&b.__AMP_EXTENDED_ELEMENTS["amp-analytics"]?Na(L(a),"amp-analytics-instrumentation"):null})};function Za(a,b,c){Ya(a).then(function(d){d&&d.triggerEventForTarget(a,b,c)})};function M(a){this.pb=a;this.Ka=[]}M.prototype.registerEventListener=function(a){this.Ka.push(a)};M.prototype.serviceEvent=function(a,b,c,d){this.event(a,Object.assign(r({serviceId:b}),c),d)};M.prototype.event=function(a,b,c){c=c||r({});var d="subscriptions-action"!==a?a:a+("-"+c.action+"-"+c.status);C().info("amp-subscriptions",d,b||"");b=b||r({});Za(this.pb,d,b);for(var e=0;e<this.Ka.length;e++)this.Ka[e](a,b,c)};
M.prototype.actionEvent=function(a,b,c,d){this.serviceEvent("subscriptions-action",a,d,r({action:b,status:c}))};function $a(a){if("undefined"!==typeof TextDecoder)return(new TextDecoder("utf-8")).decode(a);for(var b=new Uint8Array(a.buffer||a),c=Array(b.length),d=0;d<b.length;d++)c[d]=String.fromCharCode(b[d]);var e=c.join("");return decodeURIComponent(escape(e))}function ab(a){return"undefined"!==typeof TextEncoder?(new TextEncoder("utf-8")).encode(a):P(unescape(encodeURIComponent(a)))}function P(a){for(var b=new Uint8Array(a.length),c=0;c<a.length;c++){var d=a.charCodeAt(c);b[c]=d}return b};var bb={"-":"+",_:"/",".":"="};function cb(a){var b=atob(a.replace(/[-_.]/g,function(a){return bb[a]}));return P(b)};function db(a,b){if("."==b)return a;b=b.split(".");for(var c=0;c<b.length;c++){var d=b[c];if(d&&a&&void 0!==a[d]&&(null==a||"object"!=typeof a?0:Object.prototype.hasOwnProperty.call(a,d)))a=a[d];else{a=void 0;break}}return a}function eb(a,b){try{return JSON.parse(a)}catch(c){return b&&b(c),null}};function fb(a){this.h=a;this.pa=null;var b=this.h.getRootNode().querySelector("script[cryptokeys]");this.Pa=null;b&&b.hasAttribute("sha-256-hash")&&(this.Pa=b.getAttribute("sha-256-hash"));this.qb=b&&eb(b.textContent)||null}fb.prototype.getEncryptedKeys=function(){return this.qb};fb.prototype.getEncryptedDocumentKey=function(a){var b=this.getEncryptedKeys();return b?b[a]||null:null};
fb.prototype.tryToDecryptDocument=function(a){var b=this;if(!this.Pa)return gb(this,a);var c=ab(a);return crypto.subtle.digest("SHA-256",c).then(function(c){var d=ia(new Uint8Array(c)),f=d.map(function(a){a=a.toString(16);var b=2;if(!(a.length>=b)){b-=a.length;for(var c="0";b>c.length;)c+="0";a=c.slice(0,b)+a}return a}).join("");return f!=b.Pa?Promise.reject(Error("Invalid Document Key")):gb(b,a)})};
function gb(a,b){if(a.pa)return a.pa;a.pa=a.h.whenReady().then(function(){var c=a.h.getRootNode().querySelectorAll("script[ciphertext]"),d=[];Wa(c,function(a){d.push(hb(a.textContent,b).then(function(b){a.outerHTML=b}))});return Promise.all(d)});return a.pa}function hb(a,b){a=a.replace(/\s+/g,"");var c=P(atob(a));return ib(b).then(function(a){return crypto.subtle.decrypt({name:"AES-CTR",counter:new Uint8Array(16),length:128},a,c).then(function(a){return $a(new Uint8Array(a))})})}
function ib(a){var b=P(atob(a));return crypto.subtle.importKey("raw",b,"AES-CTR",!0,["decrypt"])};var jb,kb="Webkit webkit Moz moz ms O o".split(" ");function lb(a,b){var c;if(2>b.length?0:0==b.lastIndexOf("--",0))return b;jb||(jb=ja());var d=jb[b];if(!d||c){d=b;if(void 0===a[b]){var e=b.charAt(0).toUpperCase()+b.slice(1);a:{for(var f=0;f<kb.length;f++){var g=kb[f]+e;if(void 0!==a[g]){e=g;break a}}e=""}var k=e;void 0!==a[k]&&(d=k)}c||(jb[b]=d)}return d}function mb(a,b){a=a.style;for(var c in b)a.setProperty(lb(a,c),b[c].toString(),"important")}
function Q(a,b){void 0===b&&(b=a.hasAttribute("hidden"));b?a.removeAttribute("hidden"):a.setAttribute("hidden","")};function nb(a){var b=this;this.h=a;this.ia=G(a.win,"vsync");this.S=G(a.win,"timer");this.U=K(a,"viewport");this.ha=!1;this.Da=null;this.bb=Promise.resolve();a=this.h.win.document;this.B=Sa(a,"amp-subscriptions-dialog",{role:"dialog"});Q(this.B,!1);this.Ba=Sa(a,"button",{"class":"i-amphtml-subs-dialog-close-button"});this.showCloseAction(!1);this.B.appendChild(this.Ba);this.Ba.addEventListener("click",function(){b.close()});this.h.getBody().appendChild(this.B);mb(this.B,{transform:"translateY(100%)"})}
h=nb.prototype;h.getRoot=function(){return this.B};h.isVisible=function(){return this.ha};h.open=function(a,b){var c=this;b=void 0===b?!0:b;return ob(this,function(){return pb(c,a,b)})};h.close=function(){var a=this;return ob(this,function(){return qb(a)})};function ob(a,b){return a.bb=a.bb.then(b)}
function pb(a,b,c){c=void 0===c?!0:c;a.Da?a.B.replaceChild(b,a.Da):a.B.appendChild(b);a.Da=b;if(a.ha)return Promise.resolve();a.ha=!0;return a.ia.mutatePromise(function(){Q(a.B,!0);a.showCloseAction(c)}).then(function(){return a.ia.mutatePromise(function(){mb(a.B,{transform:"translateY(0)"})}).then(function(){return a.S.promise(300)})}).then(function(){var b;return a.ia.runPromise({measure:function(){b=a.B.offsetHeight},mutate:function(){a.U.updatePaddingBottom(b);a.U.addToFixedLayer(a.B,!0)}})})}
function qb(a){return a.ha?a.ia.mutatePromise(function(){mb(a.B,{transform:"translateY(100%)"})}).then(function(){return a.S.promise(300)}).then(function(){return a.ia.mutatePromise(function(){Q(a.B,!1);a.U.updatePaddingBottom(0);a.ha=!1})}):Promise.resolve()}h.showCloseAction=function(a){Q(this.Ba,a)};function rb(a){var b=a.readyState;return"loading"!=b&&"uninitialized"!=b}function sb(a,b){var c=rb,d=c(a);if(d)b(a);else{var e=function(){c(a)&&(d||(d=!0,b(a)),a.removeEventListener("readystatechange",e))};a.addEventListener("readystatechange",e)}}function tb(a){return new Promise(function(b){sb(a,b)})}function ub(a){var b=!!a.document;this.ya=b?a:a.defaultView;this.j=b?a.document:a}h=ub.prototype;h.getWin=function(){return this.ya};h.getRootNode=function(){return this.j};h.getRootElement=function(){return this.j.documentElement};
h.getHead=function(){return this.j.head};h.getBody=function(){return this.j.body};h.isReady=function(){return rb(this.j)};h.whenReady=function(){return tb(this.j)};h.addToFixedLayer=function(){return Promise.resolve()};function vb(a){return 9===a.nodeType||a.document?new ub(a):a}function R(a,b){var c=a.indexOf(":");if(-1!=c){var d=a;var e=d.substring(0,c);var f=d.substring(c+1);if("*"==f)throw Error("wildcard disallowed");}else e=a,f=d=null;this.Ma=e;this.$=d;this.tb=f;this.vb=b}
R.prototype.getPublicationId=function(){return this.Ma};R.prototype.getProductId=function(){return this.$};R.prototype.getLabel=function(){return this.tb};R.prototype.isLocked=function(){return this.vb};function wb(a){console.log.apply(console,arguments)}function xb(a){if(/swg.debug=1/.test(self.location.hash)){var b=Array.prototype.slice.call(arguments,0);b.unshift("[Subscriptions]");wb.apply(wb,b)}}
var yb="CreativeWork Article NewsArticle Blog Comment Course HowTo Message Review WebPage".split(" "),zb=new RegExp(yb.join("|"));function Ab(a){var b=this;this.j=vb(a);this.W=null;this.na=new Promise(function(a){b.W=a});this.wb=new Bb(this.j);this.ub=new Cb(this.j);this.xb=new Db(this.j)}Ab.prototype.resolveConfig=function(){Promise.resolve().then(this.check.bind(this));this.j.whenReady().then(this.check.bind(this));return this.na};
Ab.prototype.check=function(){if(!this.W)return null;var a=this.wb.check();a||(a=this.ub.check());a||(a=this.xb.check());a?(this.W(a),this.W=null):this.j.isReady()&&(this.W(Promise.reject(Error("No config could be discovered in the page"))),this.W=null);xb(a);return a};function S(){}S.prototype.checkValue=function(a,b){return a?this.checkArray(Eb(a),b):!1};S.prototype.checkString=function(a,b){return a?this.checkArray(a.split(/\s+/),b):!1};
S.prototype.checkArray=function(a,b){var c=!1;a.forEach(function(a){c=c||b.includes(a.replace(/^http:\/\/schema.org\//i,""))});return c};function Eb(a){return Array.isArray(a)?a:[a]}function Bb(a){this.j=a}Bb.prototype.check=function(){if(!this.j.getBody())return null;var a=Hb(this.j.getRootNode(),"subscriptions-product-id");if(!a)return null;var b=Hb(this.j.getRootNode(),"subscriptions-accessible-for-free"),c=b&&"false"==b.toLowerCase()||!1;return new R(a,c)};
function Cb(a){this.j=a;this.ca=new S}Cb.prototype.check=function(){if(!this.j.getBody())return null;for(var a=this.j.isReady(),b=this.j.getRootNode().querySelectorAll('script[type="application/ld+json"]'),c=0;c<b.length;c++){var d=b[c],e;if((e=!d["__SWG-SEEN__"]&&d.textContent)&&!(e=a))a:{e=d;do if(e.nextSibling){e=!0;break a}while((e=e.parentNode)&&void 0!=e);e=!1}if(e&&(d["__SWG-SEEN__"]=!0,zb.test(d.textContent))){var f=this.Ta(d);if(f)return f}}return null};
Cb.prototype.Ta=function(a){a:{try{var b=JSON.parse(a.textContent);break a}catch(f){}b=void 0}a=b;if(!a||!this.ca.checkValue(a["@type"],yb))return null;b=null;var c=Ib(a,"isPartOf");if(c)for(var d=0;d<c.length&&!(b=this.Ea(c[d]));d++);if(!b)return null;var e=Jb(Kb(a,"isAccessibleForFree"));return new R(b,!e)};function Jb(a){var b=!0;if(null==a||""===a)return b;if("boolean"==typeof a)return a;if("string"==typeof a){var c=a.toLowerCase();if("false"==c)return!1;if("true"==c)return!0}return b}
Cb.prototype.Ea=function(a){return this.ca.checkValue(a["@type"],["Product"])?Kb(a,"productID"):null};function Ib(a,b){a=a[b];return null==a||""===a?null:Array.isArray(a)?a:[a]}function Kb(a,b){var c=Ib(a,b);a=c&&c[0];return null==a||""===a?null:a}function Db(a){this.j=a;this.$=this.L=null;this.ca=new S}
function Lb(a,b){var c="alreadySeenForAccessInfo",d=b.querySelectorAll("[itemprop='isAccessibleForFree']");for(b=0;d[b];b++){var e=d[b],f=e.getAttribute("content")||e.textContent;if(f&&Mb(a,e,c)){var g=null;"true"==f.toLowerCase()?g=!0:"false"==f.toLowerCase()&&(g=!1);return g}}return null}function Mb(a,b,c){for(var d=b;d&&!d[c];d=d.parentNode)if(d[c]=!0,d.hasAttribute&&d.hasAttribute("itemscope"))return d=d.getAttribute("itemtype"),a.ca.checkString(d,yb);return!1}
Db.prototype.Ea=function(a){a=a.querySelectorAll('[itemprop="productID"]');for(var b=0;a[b];b++){var c=a[b],d=c.getAttribute("content")||c.textContent;c=c.closest("[itemtype][itemscope]");if(!(-1>=c.getAttribute("itemtype").indexOf("http://schema.org/Product"))&&Mb(this,c.parentElement,"alreadySeenForProductInfo"))return d}return null};function Nb(a){var b=null;null!=a.L?b=!a.L:a.j.isReady()&&(b=!1);return null!=a.$&&null!=b?new R(a.$,b):null}
Db.prototype.Ta=function(){var a=this,b=Nb(this);if(b)return b;for(var c=Array.prototype.slice.call(this.j.getRootNode().querySelectorAll("[itemscope][itemtype]")).filter(function(b){return a.ca.checkString(b.getAttribute("itemtype"),yb)}),d=0;c[d]&&null==b;d++)b=c[d],null==this.L&&(this.L=Lb(this,b)),this.$||(this.$=this.Ea(b)),b=Nb(this);return b};Db.prototype.check=function(){return this.j.getBody()?this.Ta():null};
function Hb(a,b){return(a=a.querySelector('meta[name="'+b+'"]'))?a.getAttribute("content"):null};function Ob(a){this.h=a;this.U=K(this.h,"viewport")}h=Ob.prototype;h.getWin=function(){return this.h.win};h.getRootNode=function(){return this.h.getRootNode()};h.getRootElement=function(){var a=this.h.getRootNode();return a.documentElement||a.body||a};h.getHead=function(){return this.h.getHeadNode()};h.getBody=function(){return this.h.isBodyAvailable()?this.h.getBody():null};h.isReady=function(){return this.h.isReady()};h.whenReady=function(){return this.h.whenReady()};
h.addToFixedLayer=function(a){return this.U.addToFixedLayer(a,!0)};function T(a){var b=a.source,c=void 0===a.raw?"":a.raw,d=a.service,e=void 0===a.granted?!1:a.granted,f=void 0===a.grantReason?"":a.grantReason,g=a.dataObject;a=a.decryptedDocumentKey;this.raw=c;this.source=b;this.service=d;this.granted=e;this.grantReason=f;this.data=g;this.decryptedDocumentKey=a}function U(a){return new T({source:"",raw:"",service:a,granted:!1})}
T.prototype.json=function(){var a=r({source:this.source,service:this.service,granted:this.granted,grantReason:this.grantReason,data:this.data});return a};T.prototype.jsonForPingback=function(){return Object.assign({},{raw:this.raw},this.json())};function Pb(a){var b=void 0===b?null:b;a||(a={});var c=b||JSON.stringify(a);return new T({source:a.source||"",raw:c,service:"",granted:a.granted||!1,grantReason:a.grantReason,dataObject:a.data||null,decryptedDocumentKey:a.decryptedDocumentKey||null})}
T.prototype.isSubscriber=function(){return this.granted&&"SUBSCRIBER"===this.grantReason};var Qb={IS_READY_TO_PAY:"isReadyToPay",SUPPORTS_VIEWER:"supportsViewer"},Rb={};function Sb(){this.C=null}h=Sb.prototype;h.add=function(a){var b=this;this.C||(this.C=[]);this.C.push(a);return function(){b.remove(a)}};h.remove=function(a){this.C&&(a=this.C.indexOf(a),-1<a&&this.C.splice(a,1))};h.removeAll=function(){this.C&&(this.C.length=0)};h.fire=function(a){if(this.C)for(var b=this.C,c=0;c<b.length;c++)(0,b[c])(a)};h.getHandlerCount=function(){return this.C?this.C.length:0};function Tb(a,b,c,d){var e=this;this.K=d||{};this.Oa=a;this.M={};this.Fa={};a.forEach(function(a){e.Fa[a]=new v});this.La=new Sb;this.cb=new Sb;this.V=this.X=this.G=this.I=null;this.ea=[];this.Ga=c;this.wa=Object.assign(Rb,b)}h=Tb.prototype;h.resolvePlatform=function(a,b){this.K[a]=b;this.cb.fire({serviceId:a})};h.resetPlatformStore=function(){for(var a in this.K)this.K[a].reset();return new Tb(this.Oa,this.wa,this.Ga,this.K)};
h.onPlatformResolves=function(a,b){var c=this,d=this.K[a];d?b(d):this.cb.add(function(d){d.serviceId===a&&b(c.getPlatform(a))})};h.getPlatform=function(a){return this.K[a]};h.getLocalPlatform=function(){var a=this.getPlatform("local");return a};h.getAvailablePlatforms=function(){var a=[],b;for(b in this.K){var c=this.K[b];a.push(c)}return a};h.onChange=function(a){this.La.add(a)};
h.resolveEntitlement=function(a,b){b&&(b.service=a);this.M[a]=b;var c=this.Fa[a];c&&c.resolve(b);-1!=this.ea.indexOf(a)&&this.ea.splice(this.ea.indexOf(a));b.granted&&Ub(this,b);this.La.fire({serviceId:a,entitlement:b})};h.getResolvedEntitlementFor=function(a){return this.M[a]};h.getEntitlementPromiseFor=function(a){return this.Fa[a].promise};
h.getScoreFactorStates=function(){var a=this,b=r({});return Promise.all(this.Oa.map(function(c){b[c]={};return Promise.all(Object.values(Qb).map(function(d){return Vb(a,c,d).then(function(a){b[c][d]=a})}))})).then(function(){return b})};function Vb(a,b,c){return a.getEntitlementPromiseFor(b).then(function(){return a.K[b].getSupportedScoreFactor(c)})}
h.getGrantStatus=function(){var a=this;if(null!==this.I)return this.I.promise;this.I=new v;for(var b in this.M){var c=this.M[b];c.granted&&(Ub(this,c),this.I.resolve(!0))}if(V(this))this.I.resolve(!1);else this.onChange(function(b){b.entitlement.granted?a.I.resolve(!0):V(a)&&a.I.resolve(!1)});return this.I.promise};function Ub(a,b){if(!a.G&&b.granted||a.G&&!a.G.isSubscriber()&&b.isSubscriber())a.G=b}
h.getGrantEntitlement=function(){var a=this;if(this.X)return this.X.promise;this.X=new v;this.G&&this.G.isSubscriber()||V(this)?this.X.resolve(this.G):this.La.add(function(){(a.G&&a.G.isSubscriber()||V(a))&&a.X.resolve(a.G)});return this.X.promise};h.reset=function(){this.I=null};h.getAllPlatformsEntitlements=function(){var a=this;if(this.V)return this.V.promise;this.V=new v;if(V(this))this.V.resolve(Wb(this));else this.onChange(function(){V(a)&&a.V.resolve(Wb(a))});return this.V.promise};
function Wb(a){var b=[],c;for(c in a.M)p.call(a.M,c)&&b.push(a.M[c]);return b}h.selectPlatform=function(){var a=this;return this.getAllPlatformsEntitlements().then(function(){var b;a:{V(a);for(b=a.getAvailablePlatforms();b.length;){var c=b.pop();if(a.getResolvedEntitlementFor(c.getServiceId()).isSubscriber()){b=c;break a}}b=Xb(a,Yb(a))}return b})};function V(a){var b=Object.keys(a.M).length;return b===a.Oa.length}
function Zb(a,b,c){c=c.getSupportedScoreFactor(b);return"number"!==typeof c?0:a.wa[b]*Math.min(1,Math.max(-1,c))}function Yb(a){return a.getAvailablePlatforms().map(function(b){return{platform:b,weight:$b(a,b)}})}function $b(a,b){var c=[0],d=b.getBaseScore(),e;for(e in a.wa)p.call(a.wa,e)&&c.push(Zb(a,e,b));return d+c.reduce(function(a,b){return a+b})}
function Xb(a,b){var c=a.getLocalPlatform();b.sort(function(a,b){return b.weight==a.weight&&a.platform==c?-1:b.weight-a.weight});return b[0].platform}function ac(a){var b=a.getAvailablePlatforms().map(function(a){var b=a.getSupportedScoreFactor("supportsViewer");return{platform:a,weight:"number"==typeof b?b:0}});return Xb(a,b)}
h.reportPlatformFailureAndFallback=function(a){if(a===this.getLocalPlatform().getServiceId()&&this.Ga)this.resolveEntitlement(this.getLocalPlatform().getServiceId(),this.Ga),C().warn("amp-subscriptions","Local platform has failed to resolve,  using fallback entitlement.");else if(-1==this.ea.indexOf(a)){var b=U(a);this.resolveEntitlement(a,b);this.ea.push(a)}};h.selectPlatformForLogin=function(){return ac(this)};function bc(a){this.h=a;this.hb=K(a,"resources");this.setGrantState(null);this.h.getBody().classList.add("i-amphtml-subs-ready");this.addLoadingBar()}function cc(a,b){a.hb.mutateElement(a.h.getBody(),function(){a.h.getBody().classList.toggle("i-amphtml-subs-grant-unk",null===b);a.h.getBody().classList.toggle("i-amphtml-subs-grant-yes",!0===b);a.h.getBody().classList.toggle("i-amphtml-subs-grant-no",!1===b)})}
bc.prototype.addLoadingBar=function(){var a=this;return this.h.whenReady().then(function(){var b=a.h.getBody();if(!b.querySelector("[subscriptions-section=loading]")){var c=Sa(a.h.win.document,"div",r({"class":"i-amphtml-subs-progress","subscriptions-section":"loading"}));b.insertBefore(c,Va(b))}})};function dc(a,b){a.hb.mutateElement(a.h.getBody(),function(){a.h.getBody().classList.toggle("i-amphtml-subs-loading",b)})}bc.prototype.setGrantState=function(a){cc(this,a)};
bc.prototype.toggleLoading=function(a){dc(this,a)};function ec(a){this.H=a}h=ec.prototype;h.getPageConfig=function(){return this.H.getPageConfig()};h.getReaderId=function(a){return this.H.getReaderId(a)};h.getEncryptedDocumentKey=function(a){return this.H.getEncryptedDocumentKey(a)};h.getAnalytics=function(){return this.H.getAnalytics()};h.getScoreFactorStates=function(){return this.H.getScoreFactorStates()};h.delegateActionToLocal=function(a){return this.delegateActionToService(a,"local")};
h.delegateActionToService=function(a,b){return this.H.delegateActionToService(a,b)};h.decorateServiceAction=function(a,b,c,d){this.H.decorateServiceAction(a,b,c,d)};h.resetPlatforms=function(){this.H.resetPlatforms()};h.getDialog=function(){return this.H.getDialog()};h.selectPlatformForLogin=function(){return this.H.selectPlatformForLogin()};function fc(a){a=a.trim();a=a.replace(/^\-+BEGIN[^-]*\-+/,"");a=a.replace(/\-+END[^-]*\-+$/,"");a=a.replace(/[\r\n]/g,"").trim();return P(atob(a))};function gc(a){this.win=a;this.xa=a.crypto&&(a.crypto.subtle||a.crypto.webkitSubtle)||null}gc.prototype.decode=function(a){return hc(a).payload};gc.prototype.isVerificationSupported=function(){return!!this.xa};
gc.prototype.decodeAndVerify=function(a,b){var c=this;if(!this.xa)throw Error("Crypto is not supported on this platform");var d=new Promise(function(b){return b(hc(a))});return d.then(function(a){var d=a.header.alg;if(!d||"RS256"!=d)throw Error("Only alg=RS256 is supported");return ic(c,b).then(function(b){var d=cb(a.sig);return c.xa.verify({name:"RSASSA-PKCS1-v1_5"},b,d,P(a.verifiable))}).then(function(b){if(b)return a.payload;throw Error("Signature verification failed");})})};
function hc(a){function b(){throw Error('Invalid token: "'+a+'"');}var c=a.split(".");3!=c.length&&b();var d=cb(c[0]),e=cb(c[1]);return{header:eb($a(d),b),payload:eb($a(e),b),verifiable:c[0]+"."+c[1],sig:c[2]}}function ic(a,b){return b.then(function(b){return a.xa.importKey("spki",fc(b),{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"])})};var W;function jc(a,b,c){var d=void 0,e=a,f=c;var g=function(a){try{return f(a)}catch(z){throw self.__AMP_REPORT_ERROR(z),z;}};var k=kc(),l=!1;d&&(l=d.capture);e.addEventListener(b,g,k?d:l);return function(){e&&e.removeEventListener(b,g,k?d:l);g=e=f=null}}function kc(){if(void 0!==W)return W;W=!1;try{var a={get capture(){W=!0}};self.addEventListener("test-options",null,a);self.removeEventListener("test-options",null,a)}catch(b){}return W};function lc(a,b){return jc(a,"message",b)}function mc(a,b){var c=b,d=jc(a,"click",function(a){try{c(a)}finally{c=null,d()}});return d};var nc=/RETURN_URL/;function oc(a,b){var c=K(a,"viewer");return(parseInt(a.getParam("dialog"),10)?new pc(c,b):new qc(a.win,c,b)).open()}function pc(a,b){this.viewer=a;this.urlOrPromise=b}pc.prototype.getLoginUrl=function(){var a="string"==typeof this.urlOrPromise?Promise.resolve(this.urlOrPromise):this.urlOrPromise;return a.then(function(a){return rc(a,"RETURN_URL")})};
pc.prototype.open=function(){var a=this;return this.getLoginUrl().then(function(b){return a.viewer.sendMessageAwaitResponse("openDialog",r({url:b}))})};function qc(a,b,c){this.win=a;this.viewer=b;this.urlOrPromise=c;this.ta=this.Y=this.da=this.w=this.Na=this.fa=null}qc.prototype.open=function(){var a=this;D(!this.fa,"Dialog already opened");return(new Promise(function(b,c){a.fa=b;a.Na=c;sc(a)})).then(function(b){tc(a);return b},function(b){tc(a);throw b;})};
function tc(a){a.fa=null;a.Na=null;if(a.w){try{a.w.close()}catch(b){}a.w=null}a.Y&&(a.win.clearInterval(a.Y),a.Y=null);a.ta&&(a.ta(),a.ta=null)}qc.prototype.getLoginUrl=function(){var a=this;return("string"==typeof this.urlOrPromise?Promise.resolve(this.urlOrPromise):this.urlOrPromise).then(function(b){return rc(b,uc(a))})};
function sc(a){var b=a.win.screen,c=Math.floor(Math.min(700,.9*b.width)),d=Math.floor(Math.min(450,.9*b.height)),e="height="+d+",width="+c+",left="+Math.floor((b.width-c)/2)+",top="+Math.floor((b.height-d)/2);b=e+",resizable=yes,scrollbars=yes";var f=uc(a);a.da=null;"string"==typeof a.urlOrPromise?(c=rc(a.urlOrPromise,f),a.w=Xa(a.win,c,b),a.w&&(a.da=Promise.resolve())):(a.w=Xa(a.win,"",b),a.w&&(a.da=a.urlOrPromise.then(function(b){b=rc(b,f);a.w.location.replace(b)},function(a){throw Error("failed to resolve url: "+
a);})));a.da?a.da.then(function(){vc(a,f)},function(b){wc(a,null,b)}):wc(a,null,Error("failed to open dialog"))}function vc(a,b){var c=E(b).origin;a.Y=a.win.setInterval(function(){a.w.closed&&(a.win.clearInterval(a.Y),a.Y=null,a.win.setTimeout(function(){wc(a,"")},3E3))},500);a.ta=lc(a.win,function(b){b.origin==c&&b.data&&"amp"==b.data.sentinel&&"result"==b.data.type&&(a.w&&a.w.postMessage(r({sentinel:"amp",type:"result-ack"}),c),wc(a,b.data.result))})}
function wc(a,b,c){a.fa&&(c?a.Na(c):a.fa(b),tc(a))}function uc(a){var b=a.viewer.getResolvedViewerUrl();if(oa().localDev){var c=a.win.location;a=c.protocol+"//"+c.host+"/extensions/amp-access/0.1/amp-login-done.html"}else a=pa.cdn+"/v0/amp-login-done-0.1.html";return a+"?url="+encodeURIComponent(b)}function rc(a,b){return nc.test(a)?a.replace(nc,encodeURIComponent(b)):a+(-1==a.indexOf("?")?"?":"&")+"return="+encodeURIComponent(b)};function xc(a,b,c,d){for(var e in d)Ga(d[e],"action "+e);this.ka=d;this.Aa={};this.T=b;this.la=c;this.N=null;this.Xa=0;this.yb=oc.bind(null,a);this.build()}xc.prototype.build=function(){var a=this;if(0==Object.keys(this.ka).length)return null;var b=[],c={},d;for(d in this.ka)c.ja=d,b.push(this.T.buildUrl(this.ka[c.ja],!0).then(function(b){return function(c){a.Aa[b.ja]=c}}(c))),c={ja:c.ja};return Promise.all(b).then(function(){return a.Aa})};
xc.prototype.execute=function(a){D(this.ka[a],"Action URL is not configured: %s",a);var b=D(this.Aa[a],"Action URL is not ready: %s",a);return yc(this,b,a)};
function yc(a,b,c){var d=Date.now();if(a.N&&1E3>d-a.Xa)return a.N;a.la.actionEvent("local",c,"started");var e=a.yb(b),f=e.then(function(b){a.N=null;b=ma(b).success;var d="true"==b||"yes"==b||"1"==b;d?a.la.actionEvent("local",c,"success"):a.la.actionEvent("local",c,"rejected");return d||!b}).catch(function(b){a.la.actionEvent("local",c,"failed");a.N==f&&(a.N=null);throw b;});a.N=f;a.Xa=d;return a.N};var zc=function(){function a(a,b,c,d){c=c||{};for(d=a.length;d--;c[a[d]]=b);return c}function b(){this.yy={}}var c=[1,3],d=[1,4],e=[1,18],f=[1,19],g=[1,14],k=[1,15],l=[1,16],m=[1,17],z=[1,21],x=[1,22],q=[5,6,7,10],w=[5,6,7,10,15,16,17,18,19,20,21],N=[5,6,7,10,15,16,17,18,19,20,21,25,27],J={trace:function(){},yy:{},Eb:{error:2,result:3,search_condition:4,EOF:5,OR:6,AND:7,NOT:8,"(":9,")":10,predicate:11,comparison_predicate:12,truthy_predicate:13,scalar_exp:14,EQ:15,DEQ:16,NEQ:17,LT:18,LTE:19,GT:20,
GTE:21,atom:22,field_ref:23,literal:24,DOT:25,field_name:26,"[":27,string:28,"]":29,NAME:30,STRING:31,NUMERIC:32,TRUE:33,FALSE:34,NULL:35,$accept:0,$end:1},ga:{2:"error",5:"EOF",6:"OR",7:"AND",8:"NOT",9:"(",10:")",15:"EQ",16:"DEQ",17:"NEQ",18:"LT",19:"LTE",20:"GT",21:"GTE",25:"DOT",27:"[",29:"]",30:"NAME",31:"STRING",32:"NUMERIC",33:"TRUE",34:"FALSE",35:"NULL"},fb:[0,[3,2],[4,3],[4,3],[4,2],[4,3],[4,1],[11,1],[11,1],[12,3],[12,3],[12,3],[12,3],[12,3],[12,3],[12,3],[13,1],[14,1],[14,1],[22,1],[23,
3],[23,4],[23,1],[26,1],[28,1],[24,1],[24,1],[24,1],[24,1],[24,1]],performAction:function(a,b,c,d,e,f){var g=f.length-1;switch(e){case 1:return f[g-1];case 2:this.m=f[g-2]||f[g];break;case 3:this.m=f[g-2]&&f[g];break;case 4:this.m=!f[g];break;case 5:this.m=f[g-1];break;case 6:case 7:case 8:case 17:case 18:case 19:this.m=f[g];break;case 9:this.m=f[g-2]===f[g];break;case 10:throw Error('"==" is not allowed, use "="');case 11:this.m=f[g-2]!==f[g];break;case 12:this.m=typeof f[g-2]==typeof f[g]&&f[g-
2]<f[g];break;case 13:this.m=typeof f[g-2]==typeof f[g]&&f[g-2]<=f[g];break;case 14:this.m=typeof f[g-2]==typeof f[g]&&f[g-2]>f[g];break;case 15:this.m=typeof f[g-2]==typeof f[g]&&f[g-2]>=f[g];break;case 16:this.m=void 0!==f[g]&&null!==f[g]&&""!==f[g]&&0!==f[g]&&!1!==f[g];break;case 20:this.m="[object Object]"==Object.prototype.toString.call(f[g-2])&&f[g-2].hasOwnProperty(f[g])?f[g-2][f[g]]:null;break;case 21:this.m="[object Object]"==Object.prototype.toString.call(f[g-3])&&f[g-3].hasOwnProperty(f[g-
1])?f[g-3][f[g-1]]:null;break;case 22:this.m=void 0!==d[f[g]]?d[f[g]]:null;break;case 23:this.m=a;break;case 24:this.m=a.substring(1,a.length-1);break;case 26:this.m=Number(a);break;case 27:this.m=!0;break;case 28:this.m=!1;break;case 29:this.m=null}},table:[{3:1,4:2,8:c,9:d,11:5,12:6,13:7,14:8,22:9,23:10,24:11,26:12,28:13,30:e,31:f,32:g,33:k,34:l,35:m},{1:[3]},{5:[1,20],6:z,7:x},{4:23,8:c,9:d,11:5,12:6,13:7,14:8,22:9,23:10,24:11,26:12,28:13,30:e,31:f,32:g,33:k,34:l,35:m},{4:24,8:c,9:d,11:5,12:6,
13:7,14:8,22:9,23:10,24:11,26:12,28:13,30:e,31:f,32:g,33:k,34:l,35:m},a(q,[2,6]),a(q,[2,7]),a(q,[2,8]),a(q,[2,16],{15:[1,25],16:[1,26],17:[1,27],18:[1,28],19:[1,29],20:[1,30],21:[1,31]}),a(w,[2,17]),a(w,[2,18],{25:[1,32],27:[1,33]}),a(w,[2,19]),a(N,[2,22]),a(w,[2,25]),a(w,[2,26]),a(w,[2,27]),a(w,[2,28]),a(w,[2,29]),a(N,[2,23]),a([5,6,7,10,15,16,17,18,19,20,21,29],[2,24]),{1:[2,1]},{4:34,8:c,9:d,11:5,12:6,13:7,14:8,22:9,23:10,24:11,26:12,28:13,30:e,31:f,32:g,33:k,34:l,35:m},{4:35,8:c,9:d,11:5,12:6,
13:7,14:8,22:9,23:10,24:11,26:12,28:13,30:e,31:f,32:g,33:k,34:l,35:m},a(q,[2,4]),{6:z,7:x,10:[1,36]},{14:37,22:9,23:10,24:11,26:12,28:13,30:e,31:f,32:g,33:k,34:l,35:m},{14:38,22:9,23:10,24:11,26:12,28:13,30:e,31:f,32:g,33:k,34:l,35:m},{14:39,22:9,23:10,24:11,26:12,28:13,30:e,31:f,32:g,33:k,34:l,35:m},{14:40,22:9,23:10,24:11,26:12,28:13,30:e,31:f,32:g,33:k,34:l,35:m},{14:41,22:9,23:10,24:11,26:12,28:13,30:e,31:f,32:g,33:k,34:l,35:m},{14:42,22:9,23:10,24:11,26:12,28:13,30:e,31:f,32:g,33:k,34:l,35:m},
{14:43,22:9,23:10,24:11,26:12,28:13,30:e,31:f,32:g,33:k,34:l,35:m},{26:44,30:e},{28:45,31:f},a([5,6,10],[2,2],{7:x}),a(q,[2,3]),a(q,[2,5]),a(q,[2,9]),a(q,[2,10]),a(q,[2,11]),a(q,[2,12]),a(q,[2,13]),a(q,[2,14]),a(q,[2,15]),a(N,[2,20]),{29:[1,46]},a(N,[2,21])],defaultActions:{20:[2,1]},parseError:function(a,b){if(b.recoverable)this.trace(a);else throw a=Error(a),a.hash=b,a;},parse:function(a){function b(){var a=n.lex()||w;"number"!==typeof a&&(a=c.Eb[a]||a);return a}var c=this,d=[0],e=[null],f=[],g=
this.table,k="",ra=0,l=0,m=0,q=2,w=1,z=f.slice.call(arguments,1),n=Object.create(this.lexer),I={yy:{}};for(t in this.yy)Object.prototype.hasOwnProperty.call(this.yy,t)&&(I.yy[t]=this.yy[t]);n.setInput(a,I.yy);I.yy.lexer=n;I.yy.parser=this;"undefined"==typeof n.yylloc&&(n.yylloc={});var x=n.yylloc;f.push(x);var N=n.options&&n.options.ranges;this.parseError="function"===typeof I.yy.parseError?I.yy.parseError:Object.getPrototypeOf(this).parseError;for(var u,J,y,O={},sa,A,Fb,ta;;){y=d[d.length-1];if(this.defaultActions[y])var t=
this.defaultActions[y];else{if(null===u||"undefined"==typeof u)u=b();t=g[y]&&g[y][u]}if("undefined"===typeof t||!t.length||!t[0]){var Gb="";ta=[];for(sa in g[y])this.ga[sa]&&sa>q&&ta.push("'"+this.ga[sa]+"'");Gb=n.showPosition?"Parse error on line "+(ra+1)+":\n"+n.showPosition()+"\nExpecting "+ta.join(", ")+", got '"+(this.ga[u]||u)+"'":"Parse error on line "+(ra+1)+": Unexpected "+(u==w?"end of input":"'"+(this.ga[u]||u)+"'");this.parseError(Gb,{text:n.match,token:this.ga[u]||u,line:n.yylineno,loc:x,
expected:ta})}if(t[0]instanceof Array&&1<t.length)throw Error("Parse Error: multiple actions possible at state: "+y+", token: "+u);switch(t[0]){case 1:d.push(u);e.push(n.yytext);f.push(n.yylloc);d.push(t[1]);u=null;J?(u=J,J=null):(l=n.yyleng,k=n.yytext,ra=n.yylineno,x=n.yylloc,0<m&&m--);break;case 2:A=this.fb[t[1]][1];O.m=e[e.length-A];O.Wa={first_line:f[f.length-(A||1)].first_line,last_line:f[f.length-1].last_line,first_column:f[f.length-(A||1)].first_column,last_column:f[f.length-1].last_column};
N&&(O.Wa.range=[f[f.length-(A||1)].range[0],f[f.length-1].range[1]]);y=this.performAction.apply(O,[k,l,ra,I.yy,t[1],e,f].concat(z));if("undefined"!==typeof y)return y;A&&(d=d.slice(0,-2*A),e=e.slice(0,-1*A),f=f.slice(0,-1*A));d.push(this.fb[t[1]][0]);e.push(O.m);f.push(O.Wa);Fb=g[d[d.length-2]][d[d.length-1]];d.push(Fb);break;case 3:return!0}}}},Xc=function(){return{EOF:1,parseError:function(a,b){if(this.yy.parser)this.yy.parser.parseError(a,b);else throw Error(a);},setInput:function(a,b){this.yy=
b||this.yy||{};this._input=a;this._more=this._backtrack=this.done=!1;this.yylineno=this.yyleng=0;this.yytext=this.matched=this.match="";this.conditionStack=["INITIAL"];this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0};this.options.ranges&&(this.yylloc.range=[0,0]);this.offset=0;return this},input:function(){var a=this._input[0];this.yytext+=a;this.yyleng++;this.offset++;this.match+=a;this.matched+=a;var b=a.match(/(?:\r\n?|\n).*/g);b?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++;
this.options.ranges&&this.yylloc.range[1]++;this._input=this._input.slice(1);return a},unput:function(a){var b=a.length,c=a.split(/(?:\r\n?|\n)/g);this._input=a+this._input;this.yytext=this.yytext.substr(0,this.yytext.length-b);this.offset-=b;var d=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1);this.matched=this.matched.substr(0,this.matched.length-1);c.length-1&&(this.yylineno-=c.length-1);a=this.yylloc.range;this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+
1,first_column:this.yylloc.first_column,last_column:c?(c.length===d.length?this.yylloc.first_column:0)+d[d.length-c.length].length-c[0].length:this.yylloc.first_column-b};this.options.ranges&&(this.yylloc.range=[a[0],a[0]+this.yyleng-b]);this.yyleng=this.yytext.length;return this},more:function(){this._more=!0;return this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+
this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(a){this.unput(this.match.slice(a))},pastInput:function(){var a=this.matched.substr(0,this.matched.length-this.match.length);return(20<a.length?"...":"")+a.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var a=this.match;20>a.length&&(a+=this._input.substr(0,20-a.length));return(a.substr(0,20)+(20<a.length?"...":"")).replace(/\n/g,"")},showPosition:function(){var a=this.pastInput(),b=Array(a.length+1).join("-");
return a+this.upcomingInput()+"\n"+b+"^"},test_match:function(a,b){var c;if(this.options.backtrack_lexer){var d={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done};
this.options.ranges&&(d.yylloc.range=this.yylloc.range.slice(0))}if(c=a[0].match(/(?:\r\n?|\n).*/g))this.yylineno+=c.length;this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:c?c[c.length-1].length-c[c.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+a[0].length};this.yytext+=a[0];this.match+=a[0];this.matches=a;this.yyleng=this.yytext.length;this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]);
this._backtrack=this._more=!1;this._input=this._input.slice(a[0].length);this.matched+=a[0];a=this.performAction.call(this,this.yy,this,b,this.conditionStack[this.conditionStack.length-1]);this.done&&this._input&&(this.done=!1);if(a)return a;if(this._backtrack)for(var e in d)this[e]=d[e];return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var a;this._more||(this.match=this.yytext="");for(var b=this._currentRules(),c=0;c<b.length;c++)if((a=this._input.match(this.rules[b[c]]))&&
(!d||a[0].length>d[0].length)){var d=a;var e=c;if(this.options.backtrack_lexer){d=this.test_match(a,b[c]);if(!1!==d)return d;if(this._backtrack)d=!1;else return!1}else if(!this.options.flex)break}return d?(d=this.test_match(d,b[e]),!1!==d?d:!1):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var a=this.next();return a?a:this.lex()},begin:function(a){this.conditionStack.push(a)},
popState:function(){return 0<this.conditionStack.length-1?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(a){a=this.conditionStack.length-1-Math.abs(a||0);return 0<=a?this.conditionStack[a]:"INITIAL"},pushState:function(a){this.begin(a)},stateStackSize:function(){return this.conditionStack.length},
options:{},performAction:function(a,b,c){switch(c){case 1:return 7;case 2:return 6;case 3:return 8;case 4:return 35;case 5:return 33;case 6:return 33;case 7:return 34;case 8:return 34;case 9:return 9;case 10:return 10;case 11:return 27;case 12:return 29;case 13:return"|";case 14:return 19;case 15:return 18;case 16:return 21;case 17:return 20;case 18:return 17;case 19:return 16;case 20:return 15;case 21:return 32;case 22:return 30;case 23:return 31;case 24:return 31;case 25:return 25;case 26:return"INVALID";
case 27:return 5}},rules:[/^(?:\s+)/,/^(?:AND\b)/,/^(?:OR\b)/,/^(?:NOT\b)/,/^(?:NULL\b)/,/^(?:TRUE\b)/,/^(?:true\b)/,/^(?:FALSE\b)/,/^(?:false\b)/,/^(?:\()/,/^(?:\))/,/^(?:\[)/,/^(?:\])/,/^(?:\|)/,/^(?:<=)/,/^(?:<)/,/^(?:>=)/,/^(?:>)/,/^(?:!=)/,/^(?:==)/,/^(?:=)/,/^(?:-?[0-9]+(\.[0-9]+)?\b)/,/^(?:[a-zA-Z_][a-zA-Z0-9_]*)/,/^(?:'[^']*')/,/^(?:"[^"]*")/,/^(?:\.)/,/^(?:.)/,/^(?:$)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27],inclusive:!0}}}}();
J.lexer=Xc;b.prototype=J;J.Parser=b;return new b}();function Ac(a,b){try{return zc.yy=b,!!zc.parse(a)}finally{zc.yy=null}};function Bc(a,b){return Ac(a,b)};function Cc(a,b,c){this.h=a;this.va=a.getRootNode();this.w=b;this.Fb=G(a.win,"templates");this.o=c}Cc.prototype.render=function(a){return Promise.all([Dc(this,a),Ec(this,a)])};Cc.prototype.reset=function(){this.w.close();return Fc(this,{},this.va,function(){return!1})};function Dc(a,b){Fc(a,b,a.va,Bc)}
function Ec(a,b){return a.h.whenReady().then(function(){for(var c=a.h.getRootNode().querySelectorAll("[subscriptions-dialog][subscriptions-display]"),d=0;d<c.length;d++){var e=c[d],f=e.getAttribute("subscriptions-display");if(f&&Ac(f,b))return e}}).then(function(c){if(c){if("TEMPLATE"==c.tagName)return a.Fb.renderTemplate(c,b).then(function(c){return Fc(a,b,c,Bc)});var d=c.cloneNode(!0);d.removeAttribute("subscriptions-dialog");d.removeAttribute("subscriptions-display");return d}}).then(function(b){if(b)return a.w.open(b,
!0)})}
function Fc(a,b,c,d){return a.h.whenReady().then(function(){for(var e='[subscriptions-action], [subscriptions-section="actions"], [subscriptions-actions]',f=c.querySelectorAll(e),g=0;g<f.length;g++){var k=f[g],l=k.getAttribute("subscriptions-display");l&&d(l,b)?(k.classList.add("i-amphtml-subs-display"),k.getAttribute("subscriptions-service")&&k.getAttribute("subscriptions-action")&&"false"!==k.getAttribute("subscriptions-decorate")&&!k.hasAttribute("i-amphtml-subs-decorated")&&(a.o.decorateServiceAction(k,k.getAttribute("subscriptions-service"),
k.getAttribute("subscriptions-action"),null),k.setAttribute("i-amphtml-subs-decorated",!0))):k.classList.remove("i-amphtml-subs-display")}return c})};function Gc(a,b){var c=a.getHeadNode();a=c;var d=a.ownerDocument.defaultView,e=d.__AMP_TOP||(d.__AMP_TOP=d),f=d!=e;if(Ha(e,"ampdoc-fie")){e.__AMP_EXPERIMENT_BRANCHES=e.__AMP_EXPERIMENT_BRANCHES||{};for(k in F)if(p.call(F,k)&&!p.call(e.__AMP_EXPERIMENT_BRANCHES,k))if(F[k].isTrafficEligible&&F[k].isTrafficEligible(e)){if(!e.__AMP_EXPERIMENT_BRANCHES[k]&&Ha(e,k)){var g=F[k].branches;e.__AMP_EXPERIMENT_BRANCHES[k]=g[Math.floor(Math.random()*g.length)]||null}}else e.__AMP_EXPERIMENT_BRANCHES[k]=null;var k=
"21065002"===(e.__AMP_EXPERIMENT_BRANCHES?e.__AMP_EXPERIMENT_BRANCHES["ampdoc-fie"]:null)}else k=!1;f&&!k?a=La(d,"url-replace")?H(d,"url-replace"):null:(a=Ka(a),a=L(a),a=La(a,"url-replace")?H(a,"url-replace"):null);this.ib=a;this.Bb=b;this.za=null}Gc.prototype.setAuthResponse=function(a){this.za=a};Gc.prototype.buildUrl=function(a,b){var c=this;return Hc(this,b).then(function(b){return c.ib.expandUrlAsync(a,b)})};
Gc.prototype.collectUrlVars=function(a,b){var c=this;return Hc(this,b).then(function(b){return c.ib.collectVars(a,b)})};function Hc(a,b){return a.Bb.then(function(c){var d={READER_ID:c,ACCESS_READER_ID:c};b&&(d.AUTHDATA=function(b){if(a.za)return db(a.za,b)});return d})};function X(a,b,c){this.h=a;this.va=a.getRootNode();this.J=b;this.Ab=!!this.J.pingbackAllEntitlements;this.o=c;this.T=new Gc(this.h,this.o.getReaderId("local"));this.A=c.getAnalytics();D(this.J.actions,"Actions have not been defined in the service config");this.Ya=new xc(this.h,this.T,this.A,this.validateActionMap(this.J.actions));this.R=new Cc(this.h,c.getDialog(),this.o)}h=X.prototype;h.getServiceId=function(){return"local"};
h.validateActionMap=function(a){D(a.login,'Action "login" is not present in action map');D(a.subscribe,'Action "subscribe" is not present in action map');return a};
function Ic(a){a.va.addEventListener("click",function(b){var c=Ua(b.target);c&&(b=c.getAttribute("subscriptions-action"),c=c.getAttribute("subscriptions-service"),"local"==c?a.executeAction(b):"auto"==(c||"auto")?"login"==b?(c=a.o.selectPlatformForLogin(),a.o.delegateActionToService(b,c.getServiceId())):a.executeAction(b):c&&a.o.delegateActionToService(b,c))})}h.activate=function(a){var b=this;Jc(this,a).then(function(a){b.R.render(a)})};
function Jc(a,b){var c=b.json();return a.o.getScoreFactorStates().then(function(b){c.factors=b;return a.T.setAuthResponse(c)}).then(function(){return a.Ya.build()}).then(function(){return c})}h.reset=function(){this.R.reset()};h.executeAction=function(a){var b=this,c=this.Ya.execute(a);return c.then(function(a){a&&b.o.resetPlatforms();return!!a})};h.isPrerenderSafe=function(){return!1};h.getSupportedScoreFactor=function(){return 0};h.getBaseScore=function(){return this.J.baseScore||0};
h.getEntitlements=function(){};h.pingback=function(){};h.pingbackReturnsAllEntitlements=function(){return this.Ab};h.isPingbackEnabled=function(){return!1};h.decorateUI=function(){};function Kc(a,b,c){this.ya=a;this.Ra=b;this.D=c;this.Z=this.Sa=null;this.Za=this.rb.bind(this);this.Cb=0;this.Va={}}h=Kc.prototype;h.connect=function(a){if(this.Z)throw Error("already connected");this.Z=a;this.ya.addEventListener("message",this.Za)};h.disconnect=function(){this.Z&&(this.Z=null,this.ya.removeEventListener("message",this.Za))};h.isConnected=function(){return null!=this.D};h.getTarget=function(){var a=Lc(this);if(!a)throw Error("not connected");return a};
function Lc(a){a.Z&&!a.Sa&&(a.Sa="function"==typeof a.Ra?a.Ra():a.Ra);return a.Sa}h.getTargetOrigin=function(){if(null==this.D)throw Error("not connected");return this.D};h.sendCommand=function(a,b){Mc(this,void 0,a,b)};h.sendCommandRsvp=function(a,b){var c=String(++this.Cb),d=null,e=new Promise(function(a){d=a});this.Va[c]={promise:e,resolver:d};Mc(this,c,a,b);return e};
function Mc(a,b,c,d){var e=a.getTarget();a="connect"==c?null!=a.D?a.D:"*":a.getTargetOrigin();e.postMessage({sentinel:"__AMP__",_rsvp:b,cmd:c,payload:d||null},a)}
h.rb=function(a){var b=this,c=a.data;if(c&&"__AMP__"==c.sentinel){var d=a.origin,e=c.cmd,f=c.payload||null;null==this.D&&"start"==e&&(this.D=d);null==this.D&&a.source&&Lc(this)==a.source&&(this.D=d);if(d==this.D){var g=c._rsvp,k=!!g&&"rsvp"!=e;a=this.Ha(g,e,f);k&&Promise.resolve(a).then(function(a){Mc(b,g,"rsvp",{result:a})},function(a){Mc(b,g,"rsvp",{error:String(a)})})}}};
h.Ha=function(a,b,c){if("rsvp"==b){var d=a&&this.Va[a];d&&("error"in c?d.resolver(Promise.reject(Error(c.error))):d.resolver(c.result),delete this.Va[a])}else return this.Z(b,c)};function Nc(a,b,c){X.call(this,a,b,c);var d=this;this.Ia=D(this.J.iframeSrc,'"iframeSrc" URL must be specified');Ga(this.Ia,"iframe Url");(this.ra=this.J.iframeVars||null)&&D(Array.isArray(this.ra),'"iframeVars" must be an array');this.D=E(this.Ia).origin;this.Ca=this.oa=null;this.sa=a.win.document.createElement("iframe");Q(this.sa,!1);this.ua=new Kc(this.h.win,function(){return d.sa.contentWindow},this.D);this.na=null;Ic(this)}ha(Nc,X);h=Nc.prototype;
h.getEntitlements=function(){var a=this;return this.connect().then(function(){return a.ua.sendCommandRsvp("authorize",{}).then(function(a){a.source="local-iframe";return a}).then(function(a){return Pb(a)})})};h.isPingbackEnabled=function(){return!0};h.pingback=function(a){var b=this;return this.connect().then(function(){return b.ua.sendCommandRsvp("pingback",{entitlement:a})})};
h.connect=function(){if(!this.Ca){var a=new v;this.Ca=a.promise;this.oa=a.resolve;this.na=Oc(this);this.ua.connect(this.Ha.bind(this));this.h.getBody().appendChild(this.sa);this.sa.src=this.Ia}return this.Ca};
function Oc(a){return new Promise(function(b){var c=JSON.parse(JSON.stringify(a.J)),d=a.o.getPageConfig();c.pageConfig={publicationId:d.getPublicationId(),productId:d.getProductId(),encryptedDocumentKey:a.o.getEncryptedDocumentKey("local")||null};if(a.ra){var e=a.ra.join("&");a.T.collectUrlVars(e,!1).then(function(a){c.iframeVars=a;b(c)})}else b(c)})}
h.Ha=function(a){var b=this;"connect"==a&&this.na.then(function(a){b.ua.sendCommandRsvp("start",{protocol:"amp-subscriptions",config:a}).then(function(){b.oa&&(b.oa(),b.oa=null)})})};function Y(a,b,c){X.call(this,a,b,c);this.kb=Ga(D(this.J.authorizationUrl,"Service config does not have authorization Url"),"Authorization Url");this.jb=G(this.h.win,"xhr");this.eb=this.J.pingbackUrl||null;Ic(this)}ha(Y,X);Y.prototype.getEntitlements=function(){var a=this;return this.T.buildUrl(this.kb,!1).then(function(b){var c=a.o.getEncryptedDocumentKey("local");c&&(b=Fa(b,c));return a.jb.fetchJson(b,{credentials:"include"}).then(function(a){return a.json()}).then(function(a){return Pb(a)})})};
Y.prototype.isPingbackEnabled=function(){return!!this.eb};function Pc(a){if(Array.isArray(a)){var b=[];a.forEach(function(a){b.push(a.jsonForPingback())});return JSON.stringify(b)}return JSON.stringify(a.jsonForPingback())}Y.prototype.pingback=function(a){var b=this;if(this.isPingbackEnabled){var c=this.eb;return this.T.buildUrl(c,!0).then(function(c){return b.jb.sendSignal(c,{method:"POST",credentials:"include",headers:r({"Content-Type":"text/plain"}),body:Pc(a)})})}};function Qc(a,b,c){return"iframe"===b.type?new Nc(a,b,c):new Y(a,b,c)};function Rc(a,b,c,d){this.h=a;this.o=c;this.O=c.getPageConfig();this.P=Qc(a,b,c);this.ba=K(this.h,"viewer");this.ba.onMessage("subscriptionchange",this.Db.bind(this));this.sb=new gc(a.win);this.Ma=this.O.getPublicationId();this.nb=this.O.getProductId();this.zb=d}h=Rc.prototype;h.isPrerenderSafe=function(){return!0};
h.getEntitlements=function(){var a=this,b=r({publicationId:this.Ma,productId:this.nb,origin:this.zb}),c=this.o.getEncryptedDocumentKey("google.com");c&&(b.encryptedDocumentKey=c);var d=this.ba.sendMessageAwaitResponse("auth",b).then(function(b){var c=(b||{}).authorization,d=(b||{}).decryptedDocumentKey;return c?Sc(a,c,d):U("local")}).catch(function(b){a.ba.sendMessage("auth-rejected",r({reason:b.message}));throw b;});return d};
function Sc(a,b,c){return new Promise(function(d){var e=Ea(a.h.win);var f=a.h.win.location;"string"==typeof f&&(f=E(f));var g=f;"string"==typeof g&&(g=E(g));if(pa.cdnProxyRegex.test(g.origin)){g=f.pathname.split("/");D(wa[g[1]],"Unknown path prefix in url %s",f.href);var k=g[2],l="s"==k?"https://"+decodeURIComponent(g[3]):"http://"+decodeURIComponent(k);D(0<l.indexOf("."),"Expected a . in origin %s",l);g.splice(1,"s"==k?3:2);g=l+g.join("/");k=(k=f.search)&&"?"!=k?(k=k.replace(za,"").replace(Aa,"").replace(Ba,
"").replace(Ca,"").replace(Da,"").replace(/^[?&]/,""))?"?"+k:"":"";f=g+k+(f.hash||"")}else f=f.href;f=E(f).origin;var m=a.sb.decode(b),z=D(a.O.getProductId(),"Product id is null");if(m.aud!=e&&m.aud!=f)throw C().createError('The mismatching "aud" field: '+m.aud);if(m.exp<Math.floor(Date.now()/1E3))throw C().createError("Payload is expired");e=m.entitlements;f=U("local");if(Array.isArray(e))for(g=0;g<e.length;g++){if(-1!==e[g].products.indexOf(z)){var x=e[g];f=new T({source:"viewer",raw:b,granted:!0,
grantReason:x.subscriptionToken?"SUBSCRIBER":"",dataObject:x,decryptedDocumentKey:c});break}}else m.metering&&!m.entitlements?f=new T({source:m.iss||"",raw:b,granted:!0,grantReason:"METERING",dataObject:m.metering,decryptedDocumentKey:c}):e&&(f=new T({source:"viewer",raw:b,granted:e.granted,grantReason:e.subscriptionToken?"SUBSCRIBER":"",dataObject:e,decryptedDocumentKey:c}));f.service="local";d(f)})}h.getServiceId=function(){return this.P.getServiceId()};h.activate=function(){};h.reset=function(){};
h.isPingbackEnabled=function(){return this.P.isPingbackEnabled()};h.pingbackReturnsAllEntitlements=function(){return this.P.pingbackReturnsAllEntitlements()};h.pingback=function(a){this.P.pingback(a)};h.getSupportedScoreFactor=function(a){return this.P.getSupportedScoreFactor(a)};h.getBaseScore=function(){return 0};h.executeAction=function(a){return this.P.executeAction(a)};h.decorateUI=function(a,b,c){return this.P.decorateUI(a,b,c)};h.Db=function(){this.o.resetPlatforms()};function Tc(a,b){var c="[subscriptions-action]:not(.i-amphtml-subs-display),[subscriptions-actions]:not(.i-amphtml-subs-display),[subscriptions-section=actions]:not(.i-amphtml-subs-display),body.i-amphtml-subs-delegated [subscriptions-section=actions],body.i-amphtml-subs-grant-unk [subscriptions-action],body.i-amphtml-subs-grant-unk [subscriptions-section=actions],body:not(.i-amphtml-subs-grant-no) [subscriptions-section=content-not-granted],body:not(.i-amphtml-subs-grant-yes) [subscriptions-section=content],body:not(.i-amphtml-subs-loading) [subscriptions-section=loading]{display:none!important}amp-subscriptions-dialog{display:block!important;position:fixed!important;bottom:0!important;left:0!important;margin-left:0!important;width:100%!important;z-index:2147483641!important;max-height:90vh;box-sizing:border-box;opacity:1;background-image:none;background-color:#fff;box-shadow:0 0 5px 0 rgba(0,0,0,0.2);margin-bottom:0;transition:transform 0.3s ease-in}.i-amphtml-subs-dialog-close-button{position:absolute;width:28px;height:28px;top:-28px;right:0;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='13' height='13' viewBox='341 8 13 13' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill='%234F4F4F' d='M354 9.31L352.69 8l-5.19 5.19L342.31 8 341 9.31l5.19 5.19-5.19 5.19 1.31 1.31 5.19-5.19 5.19 5.19 1.31-1.31-5.19-5.19z' fill-rule='evenodd'/%3E%3C/svg%3E\");background-size:13px 13px;background-position:9px;background-color:#fff;background-repeat:no-repeat;box-shadow:0 -1px 1px 0 rgba(0,0,0,0.2);border:none;border-radius:12px 0 0 0;cursor:pointer}body:not(.i-amphtml-subs-grant-yes) .i-amphtml-subs-dialog-close-button{display:none}.i-amphtml-subs-progress{height:2px;background-color:#ccc;position:relative;margin:8px;overflow:hidden}.i-amphtml-subs-progress:after{content:\"\";background-color:#2196f3;height:2px;position:absolute;left:0;top:0;width:20%;animation:i-amphtml-subs-loading-progress 1500ms ease-in-out infinite}@keyframes i-amphtml-subs-loading-progress{0%{transform:translateX(-100%)}to{transform:translateX(500%)}}@media (min-width:480px){amp-subscriptions-dialog{width:480px!important;left:-240px!important;margin-left:50vw!important}}\n/*# sourceURL=/extensions/amp-subscriptions/0.1/amp-subscriptions.css*/",
d=!1,e="amp-subscriptions",f=a.getHeadNode(),g=Uc(f,Vc(f,c),d||!1,e||null);if(b){var k=a.getRootNode();if(Wc(k,g))b(g);else var l=setInterval(function(){Wc(k,g)&&(clearInterval(l),b(g))},4)}}
function Uc(a,b,c,d){var e=a.__AMP_CSS_SM;e||(e=a.__AMP_CSS_SM=ja());var f=!c&&d&&"amp-custom"!=d&&"amp-keyframes"!=d,g=c?"amp-runtime":f?"amp-extension="+d:null;if(g){var k=Yc(a,e,g);if(k)return k.textContent!==b&&(k.textContent=b),k}var l=(a.ownerDocument||a).createElement("style");l.textContent=b;var m=null;c?l.setAttribute("amp-runtime",""):f?(l.setAttribute("amp-extension",d||""),m=Yc(a,e,"amp-runtime")):(d&&l.setAttribute(d,""),m=a.lastChild);b=m;a.insertBefore(l,b?b.nextSibling:a.firstChild);
g&&(e[g]=l);return l}function Yc(a,b,c){return b[c]?b[c]:(a=a.querySelector("style["+c+"]"))?b[c]=a:null}function Vc(a,b){return(a=a.__AMP_CSS_TR)?a(b):b}function Wc(a,b){var c=a.styleSheets;for(a=0;a<c.length;a++){var d=c[a];if(d.ownerNode==b)return!0}return!1};self.__AMP_ERRORS=self.__AMP_ERRORS||[];function Zc(a){this.h=a;this.aa=null;this.S=G(a.win,"timer");this.U=K(a,"viewport")}Zc.prototype.scheduleView=function(a){var b=this;this.aa=null;return this.h.whenReady().then(function(){return(new Promise(function(a){b.h.isVisible()&&a();b.h.onVisibilityChanged(function(){b.h.isVisible()&&a()})})).then(function(){return $c(b,a)})})};function $c(a,b){if(a.aa)return a.aa;a.aa=ad(a,b).catch(function(b){a.aa=null;throw b;});return a.aa}
function ad(a,b){if(0==b)return Promise.resolve();var c=[];return(new Promise(function(d,e){c.push(a.h.onVisibilityChanged(function(){a.h.isVisible()||e(Error("CANCELLED"))}));var f=a.S.delay(d,b);c.push(function(){return a.S.cancel(f)});c.push(a.U.onScroll(d));c.push(mc(a.h.getRootNode(),d))})).then(function(){c.forEach(function(a){return a()})},function(a){c.forEach(function(a){return a()});throw a;})};function bd(a){return new Promise(function(b){a.waitForBodyOpen().then(function(){var c=a.getBody();Ra(c,function(){return!!c.firstElementChild},function(){b("AMP-STORY"===c.firstElementChild.tagName)})})})};function cd(a){var b=a.getElementById("amp-subscriptions");this.h=a;Tc(a,function(){});this.Ja=null;this.R=new bc(a);this.l=this.F=this.O=null;this.$a=C().assertElement(b);this.A=new M(this.$a);this.o=new ec(this);this.w=new nb(a);this.Gb=new Zc(a);this.ba=K(a,"viewer");this.Ua=null;this.S=G(a.win,"timer");this.ob=(this.qa=this.ba.hasCapability("auth"))&&this.ba.hasCapability("paywall");this.mb=Na(L(a),"cid");this.gb={};this.ab=new fb(a)}
function Z(a){if(!a.Ja){var b=new Ob(a.h),c=new Ab(b);a.Ja=Promise.all([dd(a),c.resolveConfig()]).then(function(b){a.F=b[0];a.O=b[1]})}return a.Ja}function dd(a){return new Promise(function(b,c){var d=eb(a.$a.textContent,function(a){c('Failed to parse "amp-subscriptions" JSON: '+a)});b(d)})}h=cd.prototype;h.getAnalytics=function(){return this.A};
h.registerPlatform=function(a,b){var c=this;return Z(this).then(function(){if(!c.qa){var d=c.F.services.filter(function(b){return(b.serviceId||"local")===a}),e=D(d[0],"No matching services for the ID found"),f=b(e,c.o);c.l.resolvePlatform(f.getServiceId(),f);c.A.serviceEvent("subscriptions-service-registered",f.getServiceId());c.A.serviceEvent("subscriptions-platform-registered",f.getServiceId());ed(c,f)}})};
function fd(a,b){a.R.toggleLoading(!1);!b&&a.ob||a.R.setGrantState(b);a.Ua=a.Gb.scheduleView(2E3)}function gd(a,b,c){a.l.resolveEntitlement(b,c);c.decryptedDocumentKey&&a.ab.tryToDecryptDocument(c.decryptedDocumentKey);a.A.serviceEvent("subscriptions-entitlement-resolved",b)}
function ed(a,b){var c=3E3;if(oa().development||oa().localDev)c=6E3;var d=b.isPrerenderSafe()?Promise.resolve():a.h.whenFirstVisible();d.then(function(){return a.S.timeoutPromise(c,b.getEntitlements()).then(function(c){c=c||U(b.getServiceId());gd(a,b.getServiceId(),c);return c}).catch(function(c){var d=b.getServiceId();a.l.reportPlatformFailureAndFallback(d);throw C().createError("fetch entitlements failed for "+d,c);})})}
h.start=function(){var a=this;Z(this).then(function(){a.A.event("subscriptions-started");a.R.toggleLoading(!0);D(a.O,"Page config is null");if(a.qa)hd(a),id(a,!1);else if(a.F.alwaysGrant)fd(a,!0);else{D(a.F.services,"Services not configured in service config");var b=a.F.services.map(function(a){return a.serviceId||"local"});jd(a,b);a.F.services.forEach(function(b){"local"==(b.serviceId||"local")&&a.l.resolvePlatform("local",Qc(a.h,b,a.o))});a.l.getAvailablePlatforms().forEach(function(b){ed(a,b)});
bd(a.h).then(function(b){id(a,!b)})}});return this};function jd(a,b){var c=a.F.fallbackEntitlement?Pb(a.F.fallbackEntitlement):U("local");a.l=new Tb(b,a.F.score,c)}
function hd(a){var b=Ea(a.h.win);jd(a,["local"]);a.F.services.forEach(function(c){if("local"==(c.serviceId||"local")){var d=new Rc(a.h,c,a.o,b);a.l.resolvePlatform("local",d);d.getEntitlements().then(function(b){gd(a,"local",b)}).catch(function(b){a.l.reportPlatformFailureAndFallback("local");ua().error("amp-subscriptions","Viewer auth failed:",b)})}})}
h.getReaderId=function(a){var b=this.gb[a];if(!b){var c=Promise.resolve(),d="amp-access"+("local"==a?"":"-"+a);b=this.mb.then(function(a){return a.get({scope:d,createCookieIfNotPresent:!0},c)});this.gb[a]=b}return b};h.getEncryptedDocumentKey=function(a){return this.ab.getEncryptedDocumentKey(a)};h.getDialog=function(){return this.w};h.maybeSelectAndActivatePlatform=function(){var a=this;Z(this).then(function(){a.qa||a.F.alwaysGrant||kd(a)})};
function id(a,b){b=void 0===b?!0:b;a.l.getGrantStatus().then(function(b){fd(a,b);ld(a)});b&&kd(a)}
function kd(a){var b=Promise.all([a.l.getGrantStatus(),a.l.selectPlatform(),a.l.getGrantEntitlement()]);b.then(function(b){var c=b[1],e=b[2],f=a.l.getResolvedEntitlementFor(c.getServiceId()),g=e||f;c.activate(f,e);a.A.serviceEvent("subscriptions-service-activated",c.getServiceId());a.A.serviceEvent("subscriptions-platform-activated",c.getServiceId());g.granted?a.A.serviceEvent("subscriptions-access-granted",g.service):(a.A.serviceEvent("subscriptions-paywall-activated",c.getServiceId()),a.A.serviceEvent("subscriptions-access-denied",
c.getServiceId()))})}function ld(a){if(a.Ua){var b=a.l.getLocalPlatform();a.Ua.then(function(){return b.pingbackReturnsAllEntitlements()?a.l.getAllPlatformsEntitlements():a.l.getGrantEntitlement().then(function(a){return a||U("local")})}).then(function(a){b.isPingbackEnabled()&&b.pingback(a)})}}h.getPageConfig=function(){return this.O};
h.resetPlatforms=function(){var a=this;this.l=this.l.resetPlatformStore();this.R.toggleLoading(!0);this.l.getAvailablePlatforms().forEach(function(b){ed(a,b)});this.A.serviceEvent("subscriptions-service-re-authorized","");this.A.serviceEvent("subscriptions-platform-re-authorized","");id(this)};h.delegateActionToLocal=function(a){return this.delegateActionToService(a,"local")};
h.delegateActionToService=function(a,b){var c=this;return new Promise(function(d){c.l.onPlatformResolves(b,function(e){c.A.event("subscriptions-action-delegated",r({action:a,serviceId:b}),r({action:a,status:"started"}));d(e.executeAction(a))})})};h.decorateServiceAction=function(a,b,c,d){this.l.onPlatformResolves(b,function(b){b.decorateUI(a,c,d)})};h.selectPlatformForLogin=function(){return this.l.selectPlatformForLogin()};h.getAccessReaderId=function(){var a=this;return Z(this).then(function(){return a.getReaderId("local")})};
h.getAuthdataField=function(a){var b=this;return Z(this).then(function(){return b.l.getEntitlementPromiseFor("local")}).then(function(b){return db(b.json(),a)})};h.getScoreFactorStates=function(){return this.l.getScoreFactorStates()};(function(a){a.registerServiceForDoc("subscriptions",function(a){return(new cd(a)).start()})})(self.AMP);
})});

//# sourceMappingURL=amp-subscriptions-0.1.js.map
